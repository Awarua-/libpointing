# .travis.yml for libpointing
#
# Authors: Izzatbek Mukhanov
# Copyright Â© Inria
# http://libpointing.org/
#
# This software may be used and distributed according to the terms of
# the GNU General Public License version 2 or any later version.
#

language: cpp

os:
    - linux
    - osx

before_install:
    - |
      if [ $TRAVIS_OS_NAME == linux ] ; then
          sudo add-apt-repository --yes ppa:ubuntu-sdk-team/ppa ;
          sudo apt-get update -qq ;
      elif [ $TRAVIS_OS_NAME == osx ] ; then
          brew update ;
      fi

install:
    - |
      if [ $TRAVIS_OS_NAME == linux ] ; then
          sudo apt-get install -qq qt5-qmake qtbase5-dev qtdeclarative5-dev ; #qt5-default
          sudo apt-get install -qq qt5-default ;
          sudo apt-get install -qq libudev-dev ;
          sudo apt-get install -qq xorg-dev ;
          sudo apt-get install -qq freeglut3-dev ;
      elif [ $TRAVIS_OS_NAME == osx ] ; then
          brew ls | grep -wq qt || brew install qt ;
      fi

before_script:
    - qmake

script:
    - make

before_deploy:
    - |
      if [ $TRAVIS_OS_NAME == linux ] ; then
          ./building-and-packaging/linux/create-deb
      fi

deploy:
    provider: releases
    api_key:
        secure: DBrLbyfJ/+x+wT93pq7w3CPt0TU7AE9nx4UlK7sVdA2WWbyEUukH5vahA3mbgvn+WRAmi3Y2ssmiwee1+ujlZ912wBy7iWOCY0kRWJZK30Kjlh3GSPVlsXgHN5fJMlvHlGzyHasJdMP3sL/wgpXwxeoy+P0XwEw5/RWTu1JVtxwGvZC/N8Gam6CFTaKz7nDe4hk8qO8Th9sVBYzk+2sFpPXEDUb8IQn1kiU1231QeYGYtuf/Qg75Cnr6AokR5S61aQlVQEW9nSmC3KrDiR++OFt50I7xtyjIg6ToI8ZKzAdgB/VidmtFo6+uh7xCZZsdSwKHtK4QFlYO2ozkTsiuEb3njg1aqNiFPH7rXK4ZyhtLpMupLMWnKlmaRQl3cwzwVOk/WYCP0+dK2zKPypKtpf9qUjXaMNH7BRnlfL1ZgP8yOE7Lt/jYMBIhAgSst9XGEfOhV1IDrit4bhemKEXYJUsKUoKDB3JcJ17dnoRAfsCR035R75mhi95ttXDfocByqRVcIzS1YWB6LCWgIZVkcK64FWxujvNxDzHvjVCn33ZK3ez53cu23loaXUIOXeqZnGcbWVFGgAa6XPVNfEcBm/kF8hqERDz/5j+BBT2oN9HjLbsm4niN+duyUgAlV4NSp4gM50YrAPwY4IbpqO9M4HdzK/6I5C8EMM/+n9s9gPo=
    file: "building-and-packaging/linux/debian/*.deb"
    file_glob: true
    skip_cleanup: true
    on:
        tags: true
        repo: INRIA/libpointing

notifications:
    email: false